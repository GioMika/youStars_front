.gantt-container {
  display: grid;
  gap: 8px;
  padding: 9px 34px 14px 34px;
  margin: 40px 20px;
  background-color: #2A2B2E;
  color: white;
  border-radius: 20px;
}

/* Заголовок с переключением месяцев */
.gantt-header {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 8px;
  background-color: var(--bg-toggle-color);
  color: white;
  border-radius: 6px;
  position: relative;
}

.gantt-title {
  font-size: 16px;
  font-weight: normal;
  color: white;
  position: absolute;
  left: 90px;
}

.gantt-month-navigation {
  display: flex;
  align-items: center;
  gap: 10px;
}

.gantt-arrow {
  background: none;
  border: none;
  color: #ffd700;
  cursor: pointer;
  font-size: 20px;
  font-weight: bold;
  transition: transform 0.2s ease;
}

.gantt-arrow:hover {
  transform: scale(1.1);
}

.gantt-month {
  font-size: 18px;
  font-weight: bold;
  color: white;
}

/* Контент */
.gantt-content {
  display: grid;
  grid-template-columns: 1fr 3fr;
  gap: 16px;
}

/* Таблица статусов */
.gantt-status-table {
  display: grid;
  grid-auto-rows: 40px;
  gap: 15px;
  padding: 20px;
  border-radius: 8px;
  color: white;
  position: relative;
}

.gantt-status-table p {
  font-size: 16px;
  text-align: center;
  color: white;
}

.gantt-status-table .specialists {
  position: absolute;
  top: 50px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 9px;
  text-align: center;
  color: #888888;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--bg-toggle-color);
  width: calc(100% - 40px);
  border-radius: 4px;
  line-height: 1.5;
}

.gantt-status-row {
  display: flex;
  line-height: 2.1;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 6px;
  border-radius: 8px;
  background-color: var(--bg-toggle-color);
  height: 40px;
}

.gantt-status-row span:first-child {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 15px;
  height: 12px;
  background-color: #6E8AE6;
  color: black;
  font-weight: bold;
  border-radius: 5px;
  font-size: 8px;
}

.gantt-day.today {
  background-color: #68577f !important;
  color: white;
  font-weight: bold;
}

.gantt-status-row span {
  flex: 1;
  text-align: center;
  font-size: 8px;
}

/* Календарь и задачи */
.gantt-calendar-container {
  display: grid;
  grid-template-rows: auto auto;
  gap: 8px;
  overflow-x: auto; /* Добавляем горизонтальный скролл */
  white-space: nowrap; /* Запрещаем перенос строк */
  max-width: 100%;
}

.gantt-calendar {
  display: grid;
  grid-template-columns: repeat(31, 1fr);
  background: var(--bg-toggle-color);
  padding: 8px;
  border-radius: 6px;
  height: 50px;
}



.gantt-day {
  text-align: center;
  padding: 4px;
  border-top: 2px solid #555;
  border-left: 1px solid #555;
  border-right: 1px solid #555;
  font-size: 8px;
  height: 30px;
}

.gantt-day.weekend {
  background: rgba(255, 0, 0, 0.2);
  color: #fff;
}

/* Секция задач */
.gantt-tasks {
  display: grid;
  margin: 10px;
  grid-template-columns: repeat(31, 1fr);
  grid-auto-rows: 50px;
  position: relative;
  border-radius: 6px;
  align-items: center;
  background-color: var(--bg-toggle-color);
}

.gantt-task-background {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 0;
}

.gantt-task-background.weekend {
  background-color: rgba(255, 0, 0, 0.2);
}

.gantt-task {
  background: rgba(255, 255, 255, 0.1);
  padding: 4px;
  height: 85%;
  color: white;
  position: relative;
  z-index: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  text-align: center;
  border-radius: 6px;
  font-size: 12px;
}

.gantt-task:hover {
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}

/* Горизонтальные линии */
.gantt-tasks::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: repeating-linear-gradient(
    to bottom,
    transparent,
    transparent 49px,
    white 49px,
    transparent 50px
  );
  z-index: 0;
  pointer-events: none;
}

/* Вертикальные линии */
.gantt-tasks::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: repeating-linear-gradient(
    to right,
    transparent,
    transparent calc(100% / 31 - 2px),
    #2A2B2E calc(100% / 31 - 1px),
    transparent calc(100% / 31)
  );
  z-index: 0;
  pointer-events: none;
}

.gantt-empty-row {
  height: 50px;
  background: none !important;
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  pointer-events: none;
}




.gantt-tasks::before {
  height: calc(100% - 50px) !important; /* Обрезаем 50px внизу */
}
import React, { useEffect, useState } from "react";
import "./Gantt.css";
import { useDispatch, useSelector } from "react-redux";
import { AppDispatch } from "shared/store";
import { getTasks } from "shared/store/slices/tasksSlice";

type Task = {
  id: number;
  name: string;
  start: Date;
  end: Date;
  status: string;
  specialist: string;
};

const Gantt: React.FC = () => {
  const dispatch = useDispatch<AppDispatch>();
  const tasksData = useSelector((state: any) => state.tasks.tasks);

  const [tasks, setTasks] = useState<Task[]>([]);
  const [currentDate, setCurrentDate] = useState<Date>(new Date());


  

  useEffect(() => {
    const fetchTasks = async () => {
      try {
        const result = await dispatch(getTasks()).unwrap();
        const mappedTasks = result.results.map((task: any) => ({
          id: task.id,
          name: task.title,
          start: new Date(task.start_date),
          end: new Date(task.end_date),
          status: task.status,
          specialist: task.assigned_specialist,
        }));
        setTasks(mappedTasks);
      } catch (error) {
        console.error("Error fetching tasks:", error);
      }
    };
    fetchTasks();
  }, [dispatch]);

  const getDaysInMonth = (year: number, month: number): number => {
    return new Date(year, month + 1, 0).getDate();
  };


  
  const daysInMonth = getDaysInMonth(
    currentDate.getFullYear(),
    currentDate.getMonth()
  );

  const handleNextMonth = () => {
    setCurrentDate(
      new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1)
    );
  };

  const handlePreviousMonth = () => {
    setCurrentDate(
      new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1)
    );
  };

  const isWeekend = (day: number): boolean => {
    const date = new Date(
      currentDate.getFullYear(),
      currentDate.getMonth(),
      day
    );
    const dayOfWeek = date.getDay();
    return dayOfWeek === 0 || dayOfWeek === 6;
  };

  const isToday = (day: number): boolean => {
    const today = new Date();
    return (
      today.getDate() === day &&
      today.getMonth() === currentDate.getMonth() &&
      today.getFullYear() === currentDate.getFullYear()
    );
  };

  const filteredTasks = tasks.filter((task) => {
    const taskStartMonth = task.start.getMonth();
    const taskEndMonth = task.end.getMonth();
    const currentMonth = currentDate.getMonth();

    const taskStartYear = task.start.getFullYear();
    const taskEndYear = task.end.getFullYear();
    const currentYear = currentDate.getFullYear();

    return (
      (taskStartYear === currentYear && taskStartMonth === currentMonth) ||
      (taskEndYear === currentYear && taskEndMonth === currentMonth)
    );
  });

  const adjustedTasks = filteredTasks.map((task) => {
    const taskStart =
      task.start.getMonth() === currentDate.getMonth()
        ? task.start.getDate()
        : 1;
    const taskEnd =
      task.end.getMonth() === currentDate.getMonth()
        ? task.end.getDate()
        : daysInMonth;

    return {
      ...task,
      start: taskStart,
      end: taskEnd,
    };
  });

  const getStatusLabel = (status: string): string => {
    const openStatuses = ["Нужно выполнить", "in_progress"];
    const closedStatuses = ["completed", "Провалено"];

    if (openStatuses.includes(status)) return "Статус открыт";
    if (closedStatuses.includes(status)) return "Статус закрыт";

    return "Неизвестный статус";
  };

  return (
    <div className="gantt-container">
      <div className="gantt-header">
        <div className="gantt-month-navigation">
          <button onClick={handlePreviousMonth} className="gantt-arrow">
            {"<"}
          </button>
          <span className="gantt-month">
            {currentDate.toLocaleString("default", {
              month: "long",
            })}{" "}
            {currentDate.getFullYear()}
          </span>
          <button onClick={handleNextMonth} className="gantt-arrow">
            {">"}
          </button>
        </div>
      </div>

      <div className="gantt-content">
        <div className="gantt-status-table">
          <p className="graph">График времени</p>

          <p className="specialists">Специалисты / работы</p>
          {adjustedTasks.map((task) => (
            <div key={task.id} className="gantt-status-row">
              <span>{task.specialist?.[0]}</span>
              <span>{getStatusLabel(task.status)}</span>
            </div>
          ))}
        </div>
        <div className="gantt-calendar-container">
          <div className="gantt-calendar">
            {Array.from({ length: daysInMonth }, (_, i) => {
              const day = i + 1;
              return (
                <div
                  key={i}
                  className={`gantt-day ${isWeekend(day) ? "weekend" : ""} ${
                    isToday(day) ? "today" : ""
                  }`}
                >
                  {day}
                </div>
              );
            })}
          </div>

          <div className="gantt-tasks">
  {/* Сначала рендерим фон выходных */}
  {Array.from({ length: daysInMonth }, (_, i) => {
    const day = i + 1;
    const date = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
    const isWeekend = date.getDay() === 0 || date.getDay() === 6;

    return (
      <div
        key={`bg-${i}`}
        className={`gantt-task-background ${isWeekend ? "weekend" : ""}`}
        style={{
          gridColumnStart: day,
          gridColumnEnd: day + 1,
          gridRowStart: 1,
          gridRowEnd: adjustedTasks.length + 2, // Растягиваем фон на все ряды
        }}
      ></div>
    );
  })}

  {/* Затем рендерим задачи поверх фона */}
  {adjustedTasks.map((task, index) => (
    <div
      key={task.id}
      className="gantt-task"
      style={{
        gridColumnStart: task.start,
        gridColumnEnd: task.end + 1,
        gridRowStart: index + 1,
      }}
    >
      {task.name}
    </div>
  ))}


  <div
    className="gantt-empty-row"
    style={{
      gridColumnStart: 1,
      gridColumnEnd: 32, // 31 день + 1
      gridRowStart: adjustedTasks.length + 1, // Новый ряд после всех задач
    }}
  ></div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Gantt;

надо сделать так, чтобы все задачи отображались на одной странице, чтобы все месяца можно было бы прокручивать нижним скроллом и доходить до следующих задач, и чтобы когда заходило на следующий месяц , то "январь" менялся бы на февраль -  

